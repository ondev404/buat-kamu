<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>Special Message ‚Äî Onedev</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<style>
:root{
  --bg:#ffccd5; --accent:#ff3366; --black:#1a1a1a; --white:#ffffff;
  --mono:'Share Tech Mono', monospace;
}
html,body{ height:100%; margin:0; background:var(--bg); font-family:'Inter', sans-serif; overflow: hidden; display: flex; align-items: center; justify-content: center; }

/* --- BACKGROUND LOPE --- */
#bg-hearts { position: fixed; inset: 0; z-index: 0; pointer-events: none; }
.b-heart { position: absolute; color: var(--accent); opacity: 0.4; animation: b-float 4s linear infinite; }
@keyframes b-float { 0% { transform: translateY(110vh) rotate(0deg); } 100% { transform: translateY(-10vh) rotate(360deg); } }

/* --- POPUP --- */
#modalSalah {
  position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
  background: white; border: 4px solid var(--black); border-radius: 20px;
  padding: 20px; width: 220px; z-index: 1000; text-align: center;
  transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  box-shadow: 8px 8px 0px var(--black);
}
#modalSalah.show { transform: translate(-50%, -50%) scale(1); }

/* --- CONTAINER UTAMA --- */
#env-stage { position: relative; z-index: 10; display: flex; flex-direction: column; align-items: center; margin-top: 100px; }

/* --- BERUANG --- */
.bear-wrap { 
  position: absolute; width: 100px; height: 140px; 
  bottom: 120px; right: -35px;
  transform: rotate(-15deg);
  z-index: 25;
  transition: 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
  pointer-events: none;
}
.bear-head { position: relative; width: 80px; height: 70px; background: #96616b; border: 3px solid var(--black); border-radius: 50% 50% 40% 40%; z-index: 2; }
.bear-head::before, .bear-head::after { content: ""; position: absolute; width: 25px; height: 25px; background: #96616b; border: 3px solid var(--black); border-radius: 50%; top: -8px; z-index: -1; }
.bear-head::before { left: -5px; } .bear-head::after { right: -5px; }
.eye { position: absolute; width: 7px; height: 7px; background: var(--black); border-radius: 50%; top: 28px; }
.eye.l { left: 22px; } .eye.r { right: 22px; }
.muzzle { position: absolute; width: 20px; height: 14px; background: #dfb4b4; border-radius: 50%; top: 38px; left: 50%; transform: translateX(-50%); }
.nose { position: absolute; width: 8px; height: 5px; background: #5d3a41; border-radius: 50%; top: 4px; left: 50%; transform: translateX(-50%); }
.bear-body { position: absolute; width: 70px; height: 60px; background: #96616b; border: 3px solid var(--black); border-radius: 50% 50% 30% 30%; top: 55px; left: 5px; z-index: 1; }

/* --- AMPLOP --- */
.envelope { position: relative; width: 260px; height: 160px; background: var(--white); border: 4px solid var(--black); border-radius: 12px; cursor: pointer; z-index: 5; transition: 0.3s; }
.envelope::before { content: ""; position: absolute; top: 0; left: 0; border-left: 130px solid transparent; border-right: 130px solid transparent; border-top: 95px solid #f9f9f9; z-index: 8; transition: 0.5s; transform-origin: top; }
.envelope.open::before { transform: rotateX(180deg); z-index: 2; }
.letter { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 220px; height: 100px; background: white; border: 3px solid var(--black); z-index: 6; opacity: 0; transition: 0.8s ease-in-out; display: flex; align-items: center; justify-content: center; border-radius: 8px; }
.envelope.open .letter { bottom: 100px; height: 160px; opacity: 1; }
.seal { position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%); width: 45px; height: 45px; background: var(--accent); border-radius: 50%; border: 3px solid var(--black); z-index: 10; display: flex; align-items: center; justify-content: center; color: white; transition: 0.3s; }
.envelope.open .seal { opacity: 0; }

/* --- CARD --- */
.container { background: var(--white); border: 4px solid var(--black); border-radius: 24px; padding: 30px; width: 280px; text-align: center; box-shadow: 10px 10px 0px var(--black); z-index: 100; position: absolute; display: none; }
.active { display: block; animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes popUp { from { opacity: 0; transform: scale(0.9) translateY(20px); } }

/* --- SAKLAR --- */
.switch-box { margin: 25px 0; display: none; flex-direction: column; align-items: center; gap: 15px; }
.pill-switch { position: relative; display: inline-block; width: 74px; height: 38px; }
.pill-switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; inset: 0; background-color: #eee; transition: .4s; border-radius: 40px; border: 3px solid var(--black); }
.slider:before { position: absolute; content: ""; height: 24px; width: 24px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; border: 3px solid var(--black); box-shadow: 0 2px 0 var(--black); }
input:checked + .slider { background-color: var(--accent); }
input:checked + .slider:before { transform: translateX(36px); }

.msg-text { font-size: 16px; font-weight: 700; color: var(--black); min-height: 70px; line-height: 1.6; margin-bottom: 10px; }
.btn-style { width: 100%; margin: 10px 0; padding: 14px; font-family: var(--mono); font-weight: 900; cursor: pointer; border: 3px solid var(--black); border-radius: 15px; box-shadow: 4px 4px 0px var(--black); background: var(--white); transition: 0.2s; outline: none; position: relative; }
.btn-accent { background: var(--accent); color: white; }
.btn-wa { background: #25d366; color: white; }
.btn-style:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px var(--black); }

.blocks { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin: 20px 0; }
.block { width: 44px; height: 44px; border: 3px solid var(--black); border-radius: 12px; background: #fff; display: flex; align-items: center; justify-content: center; font-weight: 900; font-size: 20px; cursor: pointer; transition: 0.2s; box-shadow: 0 4px 0 var(--black); }
.block.sel { background: var(--accent); color: white; transform: translateY(2px); box-shadow: none; border-color: var(--black); }

#noBtn { background: #ffeded; position: absolute; left: 50%; transform: translateX(-50%); top: 85px; border-color: #ff3366; color: #ff3366; box-shadow: 4px 4px 0 #ff3366; }
#yesBtn { background: #00f5d4; position: absolute; left: 50%; transform: translateX(-50%); top: 5px; color: #1a1a1a; }

.wa-input { width: 100%; padding: 12px; border: 3px solid var(--black); border-radius: 10px; font-family: var(--mono); font-weight: 900; text-align: center; margin-bottom: 10px; outline: none; box-sizing: border-box; }
</style>
</head>
<body>

<audio id="myMusic" loop preload="auto">
  <source src="https://i.imgur.com/Pkitc1Z.mp4" type="audio/mpeg">
</audio>

<div id="bg-hearts"></div>

<div id="modalSalah">
  <i class="fas fa-heart-broken" style="font-size: 40px; color: var(--accent); margin-bottom: 10px;"></i>
  <p style="font-weight: 900;">Aduh! Susunannya salah. Pelan-pelan aja sayang!</p>
  <button class="btn-style btn-accent" onclick="closePopup()">ULANGI</button>
</div>

<div id="env-stage">
  <div class="bear-wrap" id="bear"><div class="bear-head"><div class="eye l"></div><div class="eye r"></div><div class="muzzle"><div class="nose"></div></div></div><div class="bear-body"></div></div>
  <div class="envelope" id="mainEnv" onclick="openSurprise()">
    <div class="letter"><i class="fas fa-heart" style="color:var(--accent); font-size: 40px;"></i></div>
    <div class="seal"><i class="fas fa-heart"></i></div>
  </div>
  <p style="margin-top:25px; font-weight:900; color:var(--black); font-family:var(--mono);">BUAT KAMU ü©∑</p>
</div>

<div class="container" id="stageMsg">
  <div class="msg-text" id="typewriter"></div>
  <div class="switch-box" id="musicToggle">
    <p style="font-size: 13px; font-weight: 900; color: #666;">On in dulu tombol iniüëá:</p>
    <label class="pill-switch">
      <input type="checkbox" id="musicCheck" onchange="toggleMusic()">
      <span class="slider"></span>
    </label>
    <div id="statusLabel" style="font-family:var(--mono); font-weight:900; font-size:12px; margin-top:8px;">OFF</div>
  </div>
  <button class="btn-style btn-accent" id="nextBtn" onclick="flow()" style="display:none">LANJUT ‚Æï</button>
</div>

<div class="container" id="game1">
  <p style="font-weight: 900; color: #888; font-size: 12px;">MISI 1</p>
  <p style="font-weight: 700; font-size: 14px;">Susun Kata "SAYANG" :</p>
  <div class="blocks">
    <div class="block" onclick="sel(this)">S</div><div class="block" onclick="sel(this)">Y</div>
    <div class="block" onclick="sel(this)">A</div><div class="block" onclick="sel(this)">N</div>
    <div class="block" onclick="sel(this)">G</div><div class="block" onclick="sel(this)">A</div>
  </div>
  <p id="p-stat" style="font-weight:900; color:var(--accent); font-size: 22px; margin-top: 10px;"></p>
</div>

<div class="container" id="gameNyebelin">
  <p id="q-title" style="font-weight: 900; color: #888; font-size: 12px;">MISI 2 (1/3)</p>
  <p id="q-text" style="font-weight: 700; font-size: 16px; margin: 15px 0;">Siapa cowok paling ganteng di mata kamu?</p>
  <div id="q-options">
    <button class="btn-style btn-accent" id="ansBtn" onclick="ansBenar()">Pastinya Kamu ‚ù§Ô∏è</button>
    <button class="btn-style" id="btnEror" onmouseover="erorTombol()">Artis Korea</button>
  </div>
</div>

<div class="container" id="gameFinal">
  <p style="font-weight:900; color: #888; font-size: 12px;">PERTANYAAN TERAKHIR</p>
  <p style="font-size: 18px;"><b>Will you be my Valentine? ‚ù§Ô∏è</b></p>
  <div style="position:relative; height:150px; margin-top:25px;">
    <button class="btn-style" id="yesBtn" onclick="finish()">MAU BANGET! üòç</button>
    <button class="btn-style" id="noBtn" onmouseover="moveNo()">Nggak</button>
  </div>
</div>

<div class="container" id="stageWA">
  <p style="font-weight:900; color: #888; font-size: 12px;">LAST BOSS!</p>
  <p style="font-weight: 700; font-size: 14px;">Kamu inget gak nomor WA pacar kamu? Coba isi dong kalo emang sayang!</p>
  <input type="tel" id="nomorWA" class="wa-input" placeholder="08xxxxxxxxxx">
  <button class="btn-style btn-wa" onclick="kirimWA()">Kirim Kasih Sayang ‚ù§Ô∏è</button>
</div>

<script>
setInterval(() => {
  const h = document.createElement('i');
  h.className = 'fas fa-heart b-heart';
  h.style.left = Math.random() * 100 + "vw";
  h.style.fontSize = (Math.random() * 15 + 10) + "px";
  document.getElementById('bg-hearts').appendChild(h);
  setTimeout(() => h.remove(), 4000);
}, 400);

let step = 0;
const messages = ["Haii, Cieee dapet surat nihüôà", "Makasih udah mau bertahan sejauh ini sama aku.", "Kamu itu rumah, tempat aku pulang paling nyaman.", "Ikutin misi ini, tolong jujur jawabnya cinta‚ù§..."];

function openSurprise() {
  document.getElementById('mainEnv').classList.add('open');
  document.getElementById('bear').style.bottom = "190px";
  setTimeout(() => {
    document.getElementById('env-stage').style.display = 'none';
    document.getElementById('stageMsg').classList.add('active');
    type();
  }, 1500);
}

function type() {
  const t = messages[step]; let i = 0;
  const el = document.getElementById('typewriter'); el.innerHTML = "";
  document.getElementById('nextBtn').style.display = "none";
  document.getElementById('musicToggle').style.display = "none";
  const timer = setInterval(() => {
    el.innerHTML += t.charAt(i); i++;
    if (i >= t.length) { 
      clearInterval(timer); 
      if (step === 0) document.getElementById('musicToggle').style.display = "flex";
      else document.getElementById('nextBtn').style.display = "block";
    }
  }, 40);
}

function toggleMusic() {
  const audio = document.getElementById('myMusic');
  if(document.getElementById('musicCheck').checked) {
    document.getElementById('statusLabel').innerText = "ON";
    document.getElementById('statusLabel').style.color = "var(--accent)";
    audio.play();
    setTimeout(() => flow(), 1200);
  } else {
    document.getElementById('statusLabel').innerText = "OFF";
    document.getElementById('statusLabel').style.color = "var(--black)";
    audio.pause();
  }
}

function flow() {
  step++;
  if (step < messages.length) type();
  else {
    document.getElementById('stageMsg').classList.remove('active');
    document.getElementById('game1').classList.add('active');
  }
}

let word = "";
function sel(e) {
  if(e.classList.contains('sel')) return;
  e.classList.add('sel'); word += e.innerText;
  document.getElementById('p-stat').innerText = word;
  if(word === "SAYANG") {
    setTimeout(() => {
      document.getElementById('game1').classList.remove('active');
      document.getElementById('gameNyebelin').classList.add('active');
    }, 800);
  } else if (word.length >= 6) {
    document.getElementById('modalSalah').classList.add('show');
  }
}
function closePopup() {
  document.getElementById('modalSalah').classList.remove('show');
  word = ""; document.querySelectorAll('.block').forEach(b => b.classList.remove('sel'));
  document.getElementById('p-stat').innerText = "";
}

let qStep = 1;
function erorTombol() {
  const btn = document.getElementById('btnEror');
  if(qStep === 1) { 
    btn.style.position = 'absolute';
    btn.style.left = Math.random() * 80 + '%'; btn.style.top = Math.random() * 80 + '%';
    btn.innerText = "Gak Bisa! üòù";
  } else if(qStep === 2) { 
    btn.style.transform = "scale(0.5)";
    btn.innerText = "Eits Gak Bisa ü•∫";
  } else { 
    btn.style.left = Math.random() * 50 + 'px';
    btn.innerText = "Salah klik! üôÑ";
  }
}

// UPDATE BAGIAN INI: Ganti teks tombol sesuai pertanyaan
function ansBenar() {
  confetti({ particleCount: 30, spread: 50 });
  qStep++;
  const btnEror = document.getElementById('btnEror');
  const btnBetul = document.getElementById('ansBtn');
  
  btnEror.style = ""; // Reset posisi tombol kabur
  
  if(qStep === 2) {
    document.getElementById('q-title').innerText = "MISI 2 (2/3)";
    document.getElementById('q-text').innerText = "Kamu punya siapa?";
    btnBetul.innerText = "Punya Kamu Dong! üë©‚Äç‚ù§Ô∏è‚Äçüë®"; // Teks tombol baru
    btnEror.innerText = "Gk tau";
  } else if(qStep === 3) {
    document.getElementById('q-title').innerText = "MISI 2 (3/3)";
    document.getElementById('q-text').innerText = "Janji jangan pernah pergi ya?";
    btnBetul.innerText = "Janji Sayang! üíñ"; // Teks tombol baru
    btnEror.innerText = "Gak janji";
  } else {
    document.getElementById('gameNyebelin').classList.remove('active');
    document.getElementById('gameFinal').classList.add('active');
  }
}

function moveNo() {
  const b = document.getElementById('noBtn');
  b.style.position = 'fixed';
  b.style.left = Math.random() * (window.innerWidth - 100) + 'px';
  b.style.top = Math.random() * (window.innerHeight - 50) + 'px';
}

function finish() {
  confetti({ particleCount: 200, spread: 80, origin: { y: 0.6 } });
  document.getElementById('gameFinal').innerHTML = `
    <h2 style="color:var(--accent)">I LOVE YOU TOO! ‚ù§Ô∏è</h2>
    <p style="font-weight:700">Seneng banget dengernya!</p>
    <button class="btn-style btn-accent" onclick="goWA()">MAU LANJUT? ‚ú®</button>
  `;
}

function goWA() {
  document.getElementById('gameFinal').classList.remove('active');
  document.getElementById('stageWA').classList.add('active');
}

function kirimWA() {
  const nomor = document.getElementById('nomorWA').value;
  if(nomor.length < 10) {
    alert("Masukin nomor yang bener dong!");
    return;
  }
  let formatted = nomor;
  if(formatted.startsWith('0')) formatted = '62' + formatted.slice(1);
  const pesan = encodeURIComponent("I LOVE YOU! ‚ù§Ô∏è");
  window.location.href = `https://wa.me/${formatted}?text=${pesan}`;
}
</script>
</body>
</html>
